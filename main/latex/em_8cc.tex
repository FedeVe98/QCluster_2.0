\hypertarget{em_8cc}{}\doxysection{em.\+cc File Reference}
\label{em_8cc}\index{em.cc@{em.cc}}
{\ttfamily \#include \char`\"{}em.\+hh\char`\"{}}\newline
{\ttfamily \#include \char`\"{}freqs.\+hh\char`\"{}}\newline
{\ttfamily \#include \char`\"{}dists.\+hh\char`\"{}}\newline
{\ttfamily \#include \char`\"{}centroid.\+hh\char`\"{}}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{em_8cc_aca464b7f54caba32eec5c4a6bb497b40}{initialize\+\_\+cache}} (int N)
\item 
bool \mbox{\hyperlink{em_8cc_a5220d105fc84d062eefb75c11c0f193f}{exceed\+\_\+max\+\_\+iterations}} (int N, int K, int $\ast$assignment, double \&distortion)
\item 
void \mbox{\hyperlink{em_8cc_ae39042552c912183d3a09d1ce00a3f0b}{deallocate\+\_\+cache}} ()
\item 
void \mbox{\hyperlink{em_8cc_a3e6512f5115315e469d2cdd57d136941}{select\+\_\+dists\+\_\+cent}} (char dist\+\_\+type, double($\ast$$\ast$distf)(double $\ast$, double $\ast$, int, double $\ast$, double $\ast$, double $\ast$, double $\ast$), void($\ast$$\ast$eval\+\_\+centroid)(int, int, double $\ast$$\ast$, int, double $\ast$$\ast$, double $\ast$, double $\ast$, double $\ast$$\ast$, double $\ast$, double $\ast$$\ast$, double $\ast$))
\item 
int \mbox{\hyperlink{em_8cc_a44d57634ccc0a96e02c9f1ad6050ddd4}{hard\+\_\+em}} (int K, int N, int row\+\_\+length, double $\ast$$\ast$data, double $\ast$$\ast$quality, double $\ast$expected\+\_\+qual, double $\ast$$\ast$quality\+\_\+1, double $\ast$expected\+\_\+freq, int num\+\_\+nt, double $\ast$$\ast$data\+\_\+1, int $\ast$assignment, double $\ast$Z, int num\+\_\+trials, char dist\+\_\+type, int verbose)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int $\ast$ \mbox{\hyperlink{em_8cc_aef954c8a61737b6481ce8be6cfc2323d}{best\+\_\+assignment}}
\item 
double \mbox{\hyperlink{em_8cc_abbaede7768e9c25335cfa74173aa57ef}{best\+\_\+distortion}}
\item 
int \mbox{\hyperlink{em_8cc_a1d10e252e778731e59f0f71afd7e727e}{iterations}}
\item 
int \mbox{\hyperlink{em_8cc_a82eead8e5a402b5c5da8b449073bad45}{max\+\_\+iterations}} = 1000
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{em_8cc_ae39042552c912183d3a09d1ce00a3f0b}\label{em_8cc_ae39042552c912183d3a09d1ce00a3f0b}} 
\index{em.cc@{em.cc}!deallocate\_cache@{deallocate\_cache}}
\index{deallocate\_cache@{deallocate\_cache}!em.cc@{em.cc}}
\doxysubsubsection{\texorpdfstring{deallocate\_cache()}{deallocate\_cache()}}
{\footnotesize\ttfamily void deallocate\+\_\+cache (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\Hypertarget{em_8cc_a5220d105fc84d062eefb75c11c0f193f}\label{em_8cc_a5220d105fc84d062eefb75c11c0f193f}} 
\index{em.cc@{em.cc}!exceed\_max\_iterations@{exceed\_max\_iterations}}
\index{exceed\_max\_iterations@{exceed\_max\_iterations}!em.cc@{em.cc}}
\doxysubsubsection{\texorpdfstring{exceed\_max\_iterations()}{exceed\_max\_iterations()}}
{\footnotesize\ttfamily bool exceed\+\_\+max\+\_\+iterations (\begin{DoxyParamCaption}\item[{int}]{N,  }\item[{int}]{K,  }\item[{int $\ast$}]{assignment,  }\item[{double \&}]{distortion }\end{DoxyParamCaption})}

Function that controls if the number of iterations without improvement of the best solution exceed a bound. If so, it substitutes the current solution with the best found so far and return true. \mbox{\Hypertarget{em_8cc_a44d57634ccc0a96e02c9f1ad6050ddd4}\label{em_8cc_a44d57634ccc0a96e02c9f1ad6050ddd4}} 
\index{em.cc@{em.cc}!hard\_em@{hard\_em}}
\index{hard\_em@{hard\_em}!em.cc@{em.cc}}
\doxysubsubsection{\texorpdfstring{hard\_em()}{hard\_em()}}
{\footnotesize\ttfamily int hard\+\_\+em (\begin{DoxyParamCaption}\item[{int}]{K,  }\item[{int}]{N,  }\item[{int}]{row\+\_\+length,  }\item[{double $\ast$$\ast$}]{freq,  }\item[{double $\ast$$\ast$}]{quality,  }\item[{double $\ast$}]{expected\+\_\+qual,  }\item[{double $\ast$$\ast$}]{quality\+\_\+1,  }\item[{double $\ast$}]{expected\+\_\+freq,  }\item[{int}]{num\+\_\+nt,  }\item[{double $\ast$$\ast$}]{freq\+\_\+1,  }\item[{int $\ast$}]{assignment,  }\item[{double $\ast$}]{Z,  }\item[{int}]{num\+\_\+trials = {\ttfamily 1},  }\item[{char}]{dist\+\_\+type = {\ttfamily \textquotesingle{}e\textquotesingle{}},  }\item[{int}]{verbose = {\ttfamily 0} }\end{DoxyParamCaption})}

Hard EM clustering K = number of clusters N = number of samples row\+\_\+length = row length of the freq matrix freq = frequencies matrix quality = quality matrix expected\+\_\+qual = vector of expected quality of each word quality\+\_\+1 = quality matrix for single bases expected\+\_\+freq = vector of expected frequencies of each word num\+\_\+nt = number of different bases (4) freq\+\_\+1 = frequencies matrix for single bases assignment = vector of cluster assignment; must be pre-\/allocated Z = flat array for storing assignment confidence; must be pre-\/allocated num\+\_\+trials = number of times to repeat clustering before chosing the result with the minimal distortion dist = distance\+: e = Euclidean, k = KL, s = symmetrized KL verbose = verbosity level Returns the number of clusters formed \mbox{\Hypertarget{em_8cc_aca464b7f54caba32eec5c4a6bb497b40}\label{em_8cc_aca464b7f54caba32eec5c4a6bb497b40}} 
\index{em.cc@{em.cc}!initialize\_cache@{initialize\_cache}}
\index{initialize\_cache@{initialize\_cache}!em.cc@{em.cc}}
\doxysubsubsection{\texorpdfstring{initialize\_cache()}{initialize\_cache()}}
{\footnotesize\ttfamily void initialize\+\_\+cache (\begin{DoxyParamCaption}\item[{int}]{N }\end{DoxyParamCaption})}

Initialize the vector that mantains the best assignment found so far. \mbox{\Hypertarget{em_8cc_a3e6512f5115315e469d2cdd57d136941}\label{em_8cc_a3e6512f5115315e469d2cdd57d136941}} 
\index{em.cc@{em.cc}!select\_dists\_cent@{select\_dists\_cent}}
\index{select\_dists\_cent@{select\_dists\_cent}!em.cc@{em.cc}}
\doxysubsubsection{\texorpdfstring{select\_dists\_cent()}{select\_dists\_cent()}}
{\footnotesize\ttfamily void select\+\_\+dists\+\_\+cent (\begin{DoxyParamCaption}\item[{char}]{dist\+\_\+type,  }\item[{double($\ast$$\ast$)(double $\ast$, double $\ast$, int, double $\ast$, double $\ast$, double $\ast$, double $\ast$)}]{distf,  }\item[{void($\ast$$\ast$)(int, int, double $\ast$$\ast$, int, double $\ast$$\ast$, double $\ast$, double $\ast$, double $\ast$$\ast$, double $\ast$, double $\ast$$\ast$, double $\ast$)}]{eval\+\_\+centroid }\end{DoxyParamCaption})}



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{em_8cc_aef954c8a61737b6481ce8be6cfc2323d}\label{em_8cc_aef954c8a61737b6481ce8be6cfc2323d}} 
\index{em.cc@{em.cc}!best\_assignment@{best\_assignment}}
\index{best\_assignment@{best\_assignment}!em.cc@{em.cc}}
\doxysubsubsection{\texorpdfstring{best\_assignment}{best\_assignment}}
{\footnotesize\ttfamily int$\ast$ best\+\_\+assignment}

\mbox{\Hypertarget{em_8cc_abbaede7768e9c25335cfa74173aa57ef}\label{em_8cc_abbaede7768e9c25335cfa74173aa57ef}} 
\index{em.cc@{em.cc}!best\_distortion@{best\_distortion}}
\index{best\_distortion@{best\_distortion}!em.cc@{em.cc}}
\doxysubsubsection{\texorpdfstring{best\_distortion}{best\_distortion}}
{\footnotesize\ttfamily double best\+\_\+distortion}

\mbox{\Hypertarget{em_8cc_a1d10e252e778731e59f0f71afd7e727e}\label{em_8cc_a1d10e252e778731e59f0f71afd7e727e}} 
\index{em.cc@{em.cc}!iterations@{iterations}}
\index{iterations@{iterations}!em.cc@{em.cc}}
\doxysubsubsection{\texorpdfstring{iterations}{iterations}}
{\footnotesize\ttfamily int iterations}

\mbox{\Hypertarget{em_8cc_a82eead8e5a402b5c5da8b449073bad45}\label{em_8cc_a82eead8e5a402b5c5da8b449073bad45}} 
\index{em.cc@{em.cc}!max\_iterations@{max\_iterations}}
\index{max\_iterations@{max\_iterations}!em.cc@{em.cc}}
\doxysubsubsection{\texorpdfstring{max\_iterations}{max\_iterations}}
{\footnotesize\ttfamily int max\+\_\+iterations = 1000}

